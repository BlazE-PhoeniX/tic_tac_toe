"use strict";const board=document.querySelector(".board"),squares=document.querySelectorAll(".board__square"),alertBG=document.querySelector(".alert-bg"),alertInfo=document.querySelector(".alert-info"),turnSwitch=document.querySelector(".switch");function resizeBoard(){board.style.height=board.clientWidth+"px",board.style.fontSize=(board.clientHeight/3-30)/10+"rem"}resizeBoard(),window.addEventListener("resize",resizeBoard);class Player{constructor(playerDiv,firstPlayer,turnSwitchKey){this.playerDiv=playerDiv,this.nameBox=playerDiv.querySelector(".player__name span"),this.name=this.nameBox.textContent.toUpperCase(),this.scoreBox=playerDiv.querySelector(".player__score span"),this.score=0,this.editButton=playerDiv.querySelector(".player__name .edit"),this.symbolBox=this.playerDiv.querySelector(".symbol"),this.symbol=this.symbolBox.textContent,this.firstPlayerInPrevGame=firstPlayer,this.switchKey=turnSwitchKey,this.switchKey.querySelector(".name").textContent=this.name,this.switchKey.querySelector(".symbol").textContent=this.symbol}}const localStorage=window.localStorage;var player1=new Player(document.querySelector(".player-1"),!1,turnSwitch.querySelector(".player-1__side")),player2=new Player(document.querySelector(".player-2"),!0,turnSwitch.querySelector(".player-2__side")),isPlayer1Turn=!0;function retriveValues(){player1.name=localStorage.getItem("player1_name"),player2.name=localStorage.getItem("player2_name"),player1.score=Number(localStorage.getItem("player1_score")),player2.score=Number(localStorage.getItem("player2_score")),"1"==localStorage.getItem("lastGameFirstPlayer")?(player1.firstPlayerInPrevGame=!0,player2.firstPlayerInPrevGame=!1):(player1.firstPlayerInPrevGame=!1,player2.firstPlayerInPrevGame=!0)}function storeValues(){localStorage.setItem("player1_name",player1.name),localStorage.setItem("player2_name",player2.name),localStorage.setItem("player1_score",player1.score),localStorage.setItem("player2_score",player2.score),player1.firstPlayerInPrevGame?localStorage.setItem("lastGameFirstPlayer","1"):localStorage.setItem("lastGameFirstPlayer","2")}function updatePage(){switchTurns(isPlayer1Turn=player2.firstPlayerInPrevGame),isPlayer1Turn||exchangeSymbols(),player1.nameBox.textContent=player1.name,player1.scoreBox.textContent=player1.score,player1.symbolBox.textContent=player1.symbol,player1.switchKey.querySelector(".name").textContent=player1.name,player1.switchKey.querySelector(".symbol").textContent=player1.symbol,player2.nameBox.textContent=player2.name,player2.scoreBox.textContent=player2.score,player2.symbolBox.textContent=player2.symbol,player2.switchKey.querySelector(".name").textContent=player2.name,player2.switchKey.querySelector(".symbol").textContent=player2.symbol}function updateName(player){player.name=prompt("Enter player name:").substring(0,8).toUpperCase(),player.nameBox.textContent=player.name,player.switchKey.querySelector(".name").textContent=player.name,storeValues()}null!=localStorage.getItem("player1_name")?(retriveValues(),updatePage()):storeValues(),player1.editButton.addEventListener("click",(function(){updateName(player1)})),player2.editButton.addEventListener("click",(function(){updateName(player2)}));const winCombinations=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];function fillSquare(square){return""==square.textContent&&(square.textContent=isPlayer1Turn?player1.symbol:player2.symbol,!0)}function checkWin(){for(var i=0;i<8;i++)if(""!=squares[winCombinations[i][0]].textContent&&squares[winCombinations[i][0]].textContent==squares[winCombinations[i][1]].textContent&&squares[winCombinations[i][1]].textContent==squares[winCombinations[i][2]].textContent)return!0;return!1}function checkDraw(){var isDraw=!0;return squares.forEach((function(square){""==square.textContent&&(isDraw=!1)})),isDraw}function switchTurns(player1turn){player1turn?(player1.playerDiv.classList.add("turn"),player2.playerDiv.classList.remove("turn"),player1.switchKey.classList.add("player-turn"),player2.switchKey.classList.remove("player-turn")):(player1.playerDiv.classList.remove("turn"),player2.playerDiv.classList.add("turn"),player1.switchKey.classList.remove("player-turn"),player2.switchKey.classList.add("player-turn"))}function updateScore(player){player.score++,player.scoreBox.textContent=player.score}function clearBoard(){squares.forEach((function(square){square.textContent=""}))}function nextGame(){clearBoard(),player1.firstPlayerInPrevGame=!player1.firstPlayerInPrevGame,player2.firstPlayerInPrevGame=!player2.firstPlayerInPrevGame,switchTurns(isPlayer1Turn=player2.firstPlayerInPrevGame),exchangeSymbols(),storeValues()}function exchangeSymbols(){var temp=player1.symbol;player1.symbol=player2.symbol,player2.symbol=temp,player1.symbolBox.textContent=player1.symbol,player1.switchKey.querySelector(".symbol").textContent=player1.symbol,player2.symbolBox.textContent=player2.symbol,player2.switchKey.querySelector(".symbol").textContent=player2.symbol}function showInfoAlert(str){alertInfo.querySelector("p").textContent=str,alertBG.style.display="block",alertInfo.style.display="flex"}function closeInfoAlert(){alertBG.style.display="none",alertInfo.style.display="none",alertInfo.querySelector("p").textContent=""}function resetCurrentGame(){clearBoard(),switchTurns(isPlayer1Turn=player2.firstPlayerInPrevGame)}function resetGame(){localStorage.clear(),player1.name="PLAYER 1",player1.score=0,player1.symbol="X",player2.name="PLAYER 2",player2.score=0,player2.symbol="O",player1.firstPlayerInPrevGame=!1,player2.firstPlayerInPrevGame=!0,clearBoard(),updatePage(),storeValues()}squares.forEach((function(square){square.addEventListener("click",(function(){var str;fillSquare(square)&&(checkWin()?(updateScore(isPlayer1Turn?player1:player2),showInfoAlert(isPlayer1Turn?player1.name+" WINS":player2.name+" WINS"),nextGame()):checkDraw()?(showInfoAlert("GAME DRAW"),nextGame()):switchTurns(isPlayer1Turn=!isPlayer1Turn))}))}));
